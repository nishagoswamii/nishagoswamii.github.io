
---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { Navbar } from '@/components/Navbar';
import Footer from '@/components/Footer';
import { GridBackground } from '@/components/GridBackground';

import { projects } from '@/data/portfolioData';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const searchPosts = posts.map(post => ({
  title: post.data.title,
  slug: post.slug
}));

const searchProjects = projects.map(p => ({
  id: p.id,
  title: p.title,
  githubUrl: p.githubUrl
}));
---

<Layout title="Blog | Nisha Goswami">
	<GridBackground client:load />
    <Navbar client:load posts={searchPosts} projects={searchProjects} />
    
    <main class="relative z-10 pt-32 pb-20 min-h-screen">
       <div class="container mx-auto px-4 max-w-3xl">
          <div class="mb-16">
             <h1 class="text-5xl font-heading font-bold mb-4">Writing</h1>
             <p class="text-xl text-muted-foreground">Thoughts on technology, design, and the future.</p>
          </div>
          
          <div class="space-y-12">
             {posts.map((post) => (
                <a href={`/blog/${post.slug}/`} class="group block">
                   <article class="flex flex-col md:flex-row gap-4 md:items-baseline justify-between border-b border-border/50 pb-8 transition-opacity hover:opacity-70">
                      <div>
                         <h2 class="text-2xl font-bold mb-2 group-hover:text-primary transition-colors">{post.data.title}</h2>
                         <p class="text-muted-foreground line-clamp-2">{post.data.description}</p>
                         {post.data.tags && (
                             <div class="flex gap-2 mt-3">
                                {post.data.tags.map(tag => (
                                    <span class="text-xs font-mono bg-secondary/30 px-2 py-1 rounded text-secondary-foreground">{tag}</span>
                                ))}
                             </div>
                         )}
                      </div>
                      <time datetime={post.data.pubDate.toISOString()} class="text-sm font-mono text-muted-foreground whitespace-nowrap">
                         {post.data.pubDate.toLocaleDateString('en-us', {
							year: 'numeric',
							month: 'short',
							day: 'numeric',
						})}
                      </time>
                   </article>
                </a>
             ))}
          </div>
       </div>
    </main>

    <Footer />
</Layout>
